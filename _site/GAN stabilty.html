<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li:not(:nth-child(1)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li > a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(1) > ul > li:nth-child(1) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(1) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(1) > ul > li:nth-child(1) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(1) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(1) > ul.nav-list > li.nav-list-item:nth-child(1) > ul.nav-list { display: block; } </style> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>GAN stability(to be continued) | Qi’s Page</title> <meta name="generator" content="Jekyll v3.9.2" /> <meta property="og:title" content="GAN stability(to be continued)" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="This is the personal webpage of Qi, who’s doing a PhD. in Max Planck Institute in Tübingen. The website will be including reseach projects, technical blogs and other interesting contents. Stay tuned ;)" /> <meta property="og:description" content="This is the personal webpage of Qi, who’s doing a PhD. in Max Planck Institute in Tübingen. The website will be including reseach projects, technical blogs and other interesting contents. Stay tuned ;)" /> <link rel="canonical" href="http://localhost:4000/GAN%20stabilty.html" /> <meta property="og:url" content="http://localhost:4000/GAN%20stabilty.html" /> <meta property="og:site_name" content="Qi’s Page" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="GAN stability(to be continued)" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"This is the personal webpage of Qi, who’s doing a PhD. in Max Planck Institute in Tübingen. The website will be including reseach projects, technical blogs and other interesting contents. Stay tuned ;)","headline":"GAN stability(to be continued)","url":"http://localhost:4000/GAN%20stabilty.html"}</script> <!-- End Jekyll SEO tag --> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ tex2jax: { inlineMath: [ ['$','$'], ["\\(","\\)"] ], processEscapes: true } }); </script> <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> Qi's Page </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Blogs category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/Blogs.html" class="nav-list-link">Blogs</a><ul class="nav-list"><li class="nav-list-item"><a href="/GAN%20stabilty.html" class="nav-list-link">GAN stability(to be continued)</a></li><li class="nav-list-item"><a href="/Gradient%20flow.html" class="nav-list-link">Gradient flow</a></li><li class="nav-list-item"><a href="/Super-resolution.html" class="nav-list-link">Super resolution on MRI</a></li></ul></li><li class="nav-list-item"><a href="/" class="nav-list-link">About me</a></li><li class="nav-list-item"><a href="/Resume.html" class="nav-list-link">Resume</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Qi's Page" aria-label="Search Qi's Page" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/Blogs.html">Blogs</a></li> <li class="breadcrumb-nav-list-item"><span>GAN stability(to be continued)</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h2 id="stablized-gan-training"> <a href="#stablized-gan-training" class="anchor-heading" aria-labelledby="stablized-gan-training"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Stablized GAN training </h2> <p>The original GAN was known for unstable during the training:</p> <ul> <li>when the fake and real sample distribution do not overlap in the early phase of training(an intrinsic requirement by the Kullback Leibler divergence).</li> </ul> \[KL(P \lVert Q) = \sum_{x=1}^{N}P(x) log{\frac{P(x)}{Q(x)}}\] <ul> <li> <p>when one of the adversarial networks overpowers the other, neither one of the two will learn informative features over the training samples;</p> </li> <li> <p>the intrisinc design of the objective function contains unwanted properties that hinders the convergence;</p> </li> </ul> <h3 id="vanishing-gradient"> <a href="#vanishing-gradient" class="anchor-heading" aria-labelledby="vanishing-gradient"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Vanishing gradient </h3> <p>From the previous equation, one could assume generated sample has distribution with various mean(e.g. $\mu$ = 0, $\mu$=5, $\mu=30$), while real sample of a normal distribution($\mathcal{N}(1,0)$). The KL divergence for those generated sample distribution of $\mu=35$ leads to saturating value, which cause the discriminator to rate 0 for $G(z), z\in Q$. Thus the gradient of generator with regards to GAN loss function is:</p> <h3 id="mode-collapse"> <a href="#mode-collapse" class="anchor-heading" aria-labelledby="mode-collapse"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Mode collapse </h3> <p>During the training, the generator always look for one type of output that is the most plausible for the discriminator, and the discriminator always reject the rest. Thus only monotomous output are generated by the generator even fed various inputs.</p> \[-\nabla_{\theta_{g}}log(1-D(G(z))) \rightarrow 0\] <h3 id="1-wasserstein-gan"> <a href="#1-wasserstein-gan" class="anchor-heading" aria-labelledby="1-wasserstein-gan"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1. Wasserstein GAN </h3> <p>The Wasserstein GAN(WGAN) is first known for effectively balance the GAN training. Where weight clipping and wasserstein metrics are used. The later describes the minimum cost of converting one distribution $q$ to another $p$, mathematically defined as the greatest lower bound(infimum) of a transport plan, this could be formulated as: \(W(p,q) = inf_{\gamma \in \Pi(\mathbb{P_{r}, \mathbb{P_{g}}})} \mathbb{E}_{(x,y) \sim \gamma} [\lVert x-y \rVert]\) where $\Pi$ contains all the possible transport plan $\gamma$.</p> <p>The above formula is intractable but could be further simplified to the follow, using Kantorovich-Rubinstein duality:</p> \[W(\mathbb{P_{r}}, \mathbb{P_{g}}) = sup_{\lVert f\rVert_{L} \leq1} \; \mathbb{E}_{x\sim \mathbb{P}_{r}}[f(x)] - \mathbb{E}_{x\sim \mathbb{P}_{g}}[f(x)]\] <p>Where $f(\cdot)$ is a Lipschitz-1 function, meaning: $\lvert f(x_{1}) - f(x_{2})\rvert \leq \lvert x_{1} - x_{2}\rvert $, and such function $f(\cdot)$ is parameterized by the critics(discriminator without the last non-linear layer). Or say, the well-trained critics is the function $f(\cdot)$. As per the Lipischtz-1 constrain, the utilization of weight clipping explicitly clips the maximum magnetude of the critics to a constant range $c$.</p> <p>Different from the gradient of the original discriminator,</p> \[\nabla_{\theta_{d}}\frac{1}{N}\sum_{i=1}^{N}[log(D(x^{(i)})) + log(1-D(G(x^{(i)})))]\] <p>it becomes:</p> \[\nabla_{\omega}\frac{1}{N}\sum_{i=1}^{N}[f_{\omega}(x^{(i)}) - f_{\omega}(G(z^{(i)}))]\] <h4 id="drawbacks"> <a href="#drawbacks" class="anchor-heading" aria-labelledby="drawbacks"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Drawbacks </h4> <p>Despite its early success in updating the generator at discriminator’s optimal, and stable training dynamics, the choise of weight clipping hyper-parameter is still tricky. Especially without batch normalization, the gradient could still vanish or explode on decreasing or increasing the magnitude of $c$. Secondly, the explicit constrain on weights also restricts the capacity of the model from learning complicated data or function.</p> <h3 id="2-wgan-gp"> <a href="#2-wgan-gp" class="anchor-heading" aria-labelledby="2-wgan-gp"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2. WGAN-GP </h3> <blockquote> <p>A differentiable function is Lipschitz-1 continous if and only if its gradient norm is 1 everywhere.</p> </blockquote> <p>On top of WGAN work, the WGAN-GP instead of explicitly constrain Lipschitz-1 continuity via weight-clipping, it interpolates between real and generated data distribution to ensure gradient norm of 1. As is proven in the appendix A of the paper: \(\mathbb{P}_{(x,y)\sim \pi}[\nabla f^{*}(x_{t}) = \frac{y-x_{t}}{\lVert y-x_{t}\rVert}] = 1\) Where $\pi(x=y)=0$ and $x_{t} = tx_{g} + (1-t)x_{r}\text{, with } 0\leq t\leq 1$. The WGAN loss improves to:</p> \[W_{GP}(\mathbb{P}_{r}, \mathbb{P}_{g}) = \mathbb{E}_{x\sim \mathbb{P}_{r}}[f(x)] - \mathbb{E}_{x\sim \mathbb{P}_{g}}[f(x)] + \lambda \mathbb{E}_{x_{t}\sim \mathbb{P}_{x_{t}}}[(\lVert \nabla_{x_{t}}(D(x_{t}))\rVert_{2} - 1)^{2}]\] <p>Differently, WGAN-GP does not use batch normalization to avoid creating correlation among data inside mini-batch.</p> <h3 id="pros"> <a href="#pros" class="anchor-heading" aria-labelledby="pros"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Pros </h3> <p>The WGAN-GP variant offers better convergence and more constistent performance after convergence, compared to DCGAN. Eventhough it requires more computation complexity.</p> <h2 id="the-overlooked-roles-of-the-discriminator"> <a href="#the-overlooked-roles-of-the-discriminator" class="anchor-heading" aria-labelledby="the-overlooked-roles-of-the-discriminator"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> The overlooked roles of the discriminator </h2> <p>The discriminator is commonly regarded as one player of the competing game, while it actually acts a measurement of the divergence.</p> <p><a href="https://hits.sh/www.wqlevi.tk/GAN%20stabilty.html/"><img src="https://hits.sh/www.wqlevi.tk/GAN%20stabilty.html.svg" alt="Hits" /></a></p> </main> <hr> <footer> <div class="d-flex mt-2"> </div> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
